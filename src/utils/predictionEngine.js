/**
 * Simple Vedic Prediction Engine
 * Provides interpretations based on Lagna (Ascendant) and planetary placements.
 */

const SIGN_TRAITS = {
    1: { name: "рдореЗрд╖", element: "рдЕрдЧреНрдирд┐", nature: "рдЪрд░", ruler: "рдордВрдЧрд▓", traits: "рд╕рд╛рд╣рд╕реА, рдКрд░реНрдЬрд╛рд╡рд╛рди, рдиреЗрддреГрддреНрд╡ рдХреНрд╖рдорддрд╛" },
    2: { name: "рд╡реГрд╖рдн", element: "рдкреГрдереНрд╡реА", nature: "рд╕реНрдерд┐рд░", ruler: "рд╢реБрдХреНрд░", traits: "рдзреИрд░реНрдпрд╡рд╛рди, рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп, рдХрд▓рд╛рдкреНрд░реЗрдореА" },
    3: { name: "рдорд┐рдереБрди", element: "рд╡рд╛рдпреБ", nature: "рджреНрд╡рд┐рд╕реНрд╡рднрд╛рд╡", ruler: "рдмреБрдз", traits: "рдмреБрджреНрдзрд┐рдорд╛рди, рдЬрд┐рдЬреНрдЮрд╛рд╕реБ, рдорд┐рд▓рдирд╕рд╛рд░" },
    4: { name: "рдХрд░реНрдХ", element: "рдЬрд▓", nature: "рдЪрд░", ruler: "рдЪрдиреНрджреНрд░", traits: "рднрд╛рд╡реБрдХ, рд╕рдВрд╡реЗрджрдирд╢реАрд▓, рд╕реБрд░рдХреНрд╖рд╛рддреНрдордХ" },
    5: { name: "рд╕рд┐рдВрд╣", element: "рдЕрдЧреНрдирд┐", nature: "рд╕реНрдерд┐рд░", ruler: "рд╕реВрд░реНрдп", traits: "рдЖрддреНрдорд╡рд┐рд╢реНрд╡рд╛рд╕реА, рдЙрджрд╛рд░, рд░рд╛рдЬрд╕реА" },
    6: { name: "рдХрдиреНрдпрд╛", element: "рдкреГрдереНрд╡реА", nature: "рджреНрд╡рд┐рд╕реНрд╡рднрд╛рд╡", ruler: "рдмреБрдз", traits: "рд╡рд┐рд╢реНрд▓реЗрд╖рдгрд╛рддреНрдордХ, рд╕рд▓реАрдХреЗрджрд╛рд░, рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ" },
    7: { name: "рддреБрд▓рд╛", element: "рд╡рд╛рдпреБ", nature: "рдЪрд░", ruler: "рд╢реБрдХреНрд░", traits: "рд╕рдВрддреБрд▓рд┐рдд, рдХреВрдЯрдиреАрддрд┐рдХ, рдиреНрдпрд╛рдпрдкреНрд░рд┐рдп" },
    8: { name: "рд╡реГрд╢реНрдЪрд┐рдХ", element: "рдЬрд▓", nature: "рд╕реНрдерд┐рд░", ruler: "рдордВрдЧрд▓", traits: "рдЧрд╣рди, рдЧреБрдкреНрдд, рд╢рдХреНрддрд┐рд╢рд╛рд▓реА" },
    9: { name: "рдзрдиреБ", element: "рдЕрдЧреНрдирд┐", nature: "рджреНрд╡рд┐рд╕реНрд╡рднрд╛рд╡", ruler: "рдЧреБрд░реБ", traits: "рдЖрд╢рд╛рд╡рд╛рджреА, рджрд╛рд░реНрд╢рдирд┐рдХ, рд╕рд╛рд╣рд╕реА" },
    10: { name: "рдордХрд░", element: "рдкреГрдереНрд╡реА", nature: "рдЪрд░", ruler: "рд╢рдирд┐", traits: "рдЕрдиреБрд╢рд╛рд╕рд┐рдд, рдорд╣рддреНрд╡рд╛рдХрд╛рдВрдХреНрд╖реА, рдзреИрд░реНрдпрд╡рд╛рди" },
    11: { name: "рдХреБрдВрдн", element: "рд╡рд╛рдпреБ", nature: "рд╕реНрдерд┐рд░", ruler: "рд╢рдирд┐", traits: "рдкреНрд░рдЧрддрд┐рд╢реАрд▓, рдорд╛рдирд╡реАрдп, рд╕реНрд╡рддрдВрддреНрд░" },
    12: { name: "рдореАрди", element: "рдЬрд▓", nature: "рджреНрд╡рд┐рд╕реНрд╡рднрд╛рд╡", ruler: "рдЧреБрд░реБ", traits: "рдХрд▓реНрдкрдирд╛рд╢реАрд▓, рдЖрдзреНрдпрд╛рддреНрдорд┐рдХ, рджрдпрд╛рд▓реБ" }
};

const CATEGORIES = {
    OVERVIEW: { title: "рдЬреАрд╡рди рдХрд╛ рдЕрд╡рд▓реЛрдХрди (General Overview)", icon: "тЬи" },
    CAREER: { title: "рдХрд░рд┐рдпрд░ рдФрд░ рдкреНрд░рддрд┐рднрд╛ (Career & Talent)", icon: "ЁЯТ╝" },
    FINANCE: { title: "рдзрди рдФрд░ рд╕рдВрдкрддреНрддрд┐ (Wealth & Finance)", icon: "ЁЯТ░" },
    RELATIONSHIP: { title: "рд╕рдВрдмрдВрдз рдФрд░ рд╡рд┐рд╡рд╛рд╣ (Relationships)", icon: "тЭдя╕П" },
    FAMILY: { title: "рдкрд░рд┐рд╡рд╛рд░ рдФрд░ рд╕реБрдЦ (Family & Home)", icon: "ЁЯПа" },
    TRAVEL: { title: "рд╡рд┐рджреЗрд╢ рдпрд╛рддреНрд░рд╛ (Foreign Travel)", icon: "тЬИя╕П" },
    HEALTH: { title: "рд╕реНрд╡рд╛рд╕реНрдереНрдп рдФрд░ рдХрд▓реНрдпрд╛рдг (Health)", icon: "ЁЯй║" }
};

// Interpretation logic based on House Number + Rashi ID
const INTERPRETATIONS = {
    // 1st House (Self, Overview)
    1: {
        1: "рдЖрдкрдХрд╛ рд╡реНрдпрдХреНрддрд┐рддреНрд╡ рд╕рд╛рд╣рд╕реА рдФрд░ рд╕реНрд╡рддрдВрддреНрд░ рд╣реИред рдЖрдк рдирдИ рд╢реБрд░реБрдЖрдд рдХрд░рдиреЗ рдореЗрдВ рдбрд░рддреЗ рдирд╣реАрдВ рд╣реИрдВред",
        2: "рдЖрдк рд╢рд╛рдВрдд рдФрд░ рд╕реНрдерд┐рд░ рд╕реНрд╡рднрд╛рд╡ рдХреЗ рд╣реИрдВред рднреМрддрд┐рдХ рд╕реБрдЦ-рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЗ рдкреНрд░рддрд┐ рдЖрдкрдХрд╛ рдЭреБрдХрд╛рд╡ рд░рд╣реЗрдЧрд╛ред",
        3: "рдЖрдк рдмреБрджреНрдзрд┐рдорд╛рди рдФрд░ рдмрд╣реБрдореБрдЦреА рдкреНрд░рддрд┐рднрд╛ рдХреЗ рдзрдиреА рд╣реИрдВред рдЖрдкрдХреА рд╕рдВрд╡рд╛рдж рдХрд▓рд╛ рдмрд╣реБрдд рдкреНрд░рднрд╛рд╡реА рд╣реИред",
        4: "рдЖрдк рдЕрддреНрдпрдВрдд рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдФрд░ рднрд╛рд╡рдирд╛ рдкреНрд░рдзрд╛рди рд╡реНрдпрдХреНрддрд┐ рд╣реИрдВред рдкрд░рд┐рд╡рд╛рд░ рдЖрдкрдХреЗ рд▓рд┐рдП рд╕рд░реНрд╡реЛрдкрд░рд┐ рд╣реИред",
        5: "рдЖрдкрдХрд╛ рд╡реНрдпрдХреНрддрд┐рддреНрд╡ рд░рд╛рдЬрд╕реА рдФрд░ рдкреНрд░рднрд╛рд╡рд╢рд╛рд▓реА рд╣реИред рдЖрдк рд╕реНрд╡рд╛рднрд╛рд╡рд┐рдХ рдиреЗрддреГрддреНрд╡ рдХреНрд╖рдорддрд╛ рд░рдЦрддреЗ рд╣реИрдВред",
        6: "рдЖрдк рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рдФрд░ рд╡рд┐рд╡рд░рдгреЛрдВ рдкрд░ рдзреНрдпрд╛рди рджреЗрдиреЗ рд╡рд╛рд▓реЗ рд╡реНрдпрдХреНрддрд┐ рд╣реИрдВред рд╕реЗрд╡рд╛ рднрд╛рд╡ рдЖрдкрдХрд╛ рдЧреБрдг рд╣реИред",
        7: "рдЖрдк рд╢рд╛рдВрддрд┐рдкреНрд░рд┐рдп рдФрд░ рдиреНрдпрд╛рдпрдкреНрд░рд┐рдп рд╣реИрдВред рд░рд┐рд╢реНрддреЛрдВ рдореЗрдВ рд╕рдВрддреБрд▓рди рдмрдирд╛рдирд╛ рдЖрдкрдХреА рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рд╣реИред",
        8: "рдЖрдк рдЧрд╣рд░реЗ рдФрд░ рд░рд╣рд╕реНрдпрдордпреА рд╡реНрдпрдХреНрддрд┐рддреНрд╡ рд╡рд╛рд▓реЗ рд╣реИрдВред рдЖрдкрдХреА рдЗрдЪреНрдЫрд╛рд╢рдХреНрддрд┐ рдмрд╣реБрдд рдордЬрдмреВрдд рд╣реИред",
        9: "рдЖрдк рджрд╛рд░реНрд╢рдирд┐рдХ рдФрд░ рдЙрдЪреНрдЪ рд╡рд┐рдЪрд╛рд░реЛрдВ рд╡рд╛рд▓реЗ рд╡реНрдпрдХреНрддрд┐ рд╣реИрдВред рдЬреНрдЮрд╛рди рдХреА рдЦреЛрдЬ рдЖрдкрдХрд╛ рд▓рдХреНрд╖реНрдп рд╣реИред",
        10: "рдЖрдк рдЕрдиреБрд╢рд╛рд╕рд┐рдд рдФрд░ рдХрдард┐рди рдкрд░рд┐рд╢реНрд░рдореА рд╣реИрдВред рдЖрдк рдзреАрд░реЗ-рдзреАрд░реЗ рд▓реЗрдХрд┐рди рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рд╕рдлрд▓ рд╣реЛрддреЗ рд╣реИрдВред",
        11: "рдЖрдк рдХреНрд░рд╛рдВрддрд┐рдХрд╛рд░реА рд╡рд┐рдЪрд╛рд░реЛрдВ рд╡рд╛рд▓реЗ рдФрд░ рдорд╛рдирд╡реАрдп рд╕реНрд╡рднрд╛рд╡ рдХреЗ рд╣реИрдВред рдЖрдк рд╕рдорд╛рдЬ рдореЗрдВ рдмрджрд▓рд╛рд╡ рдЪрд╛рд╣рддреЗ рд╣реИрдВред",
        12: "рдЖрдк рдмрд╣реБрдд рдХрд▓реНрдкрдирд╛рд╢реАрд▓ рдФрд░ рдЖрдзреНрдпрд╛рддреНрдорд┐рдХ рд╣реИрдВред рдЖрдкрдХреА рдЕрдВрддрд░реНрдЬреНрдЮрд╛рди рд╢рдХреНрддрд┐ (Intuition) рддреАрд╡реНрд░ рд╣реИред"
    },
    // 10th House (Career)
    10: {
        1: "рдкреБрд▓рд┐рд╕, рд╕реЗрдирд╛ рдпрд╛ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рдЬреИрд╕реЗ рдЧрддрд┐рд╢реАрд▓ рдХреНрд╖реЗрддреНрд░реЛрдВ рдореЗрдВ рд╕рдлрд▓рддрд╛ рдХреЗ рдпреЛрдЧ рд╣реИрдВред",
        2: "рдмреИрдВрдХрд┐рдВрдЧ, рдХрд▓рд╛ рдпрд╛ рд╡рд┐рд▓рд╛рд╕рд┐рддрд╛ рдХреЗ рд╕рд╛рдорд╛рдиреЛрдВ рдХреЗ рд╡реНрдпрд╛рдкрд╛рд░ рдореЗрдВ рд▓рд╛рдн рдорд┐рд▓реЗрдЧрд╛ред",
        3: "рд▓реЗрдЦрди, рдкрддреНрд░рдХрд╛рд░рд┐рддрд╛ рдпрд╛ рдорд╛рд░реНрдХреЗрдЯрд┐рдВрдЧ рдХреЗ рдХреНрд╖реЗрддреНрд░ рдЖрдкрдХреЗ рд▓рд┐рдП рд╢реНрд░реЗрд╖реНрда рд╣реИрдВред",
        4: "рдбреЗрдпрд░реА, рд╣реЛрдЯрд▓ рдпрд╛ рдЪрд┐рдХрд┐рддреНрд╕рд╛ (рдирд░реНрд╕рд┐рдВрдЧ) рдХреЗ рдХрд╛рд░реНрдпреЛрдВ рдореЗрдВ рдЕрдЪреНрдЫреА рдкреНрд░рдЧрддрд┐ рд╣реЛрдЧреАред",
        5: "рд╕рд░рдХрд╛рд░реА рд╕реЗрд╡рд╛, рд░рд╛рдЬрдиреАрддрд┐ рдпрд╛ рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рдкрджреЛрдВ рдкрд░ рдЙрдЪреНрдЪ рд╕рдлрд▓рддрд╛ рдорд┐рд▓реЗрдЧреАред",
        6: "рд▓реЗрдЦрд╛рдкрд░реАрдХреНрд╖рд╛ (Audit), рд╢рд┐рдХреНрд╖рдг рдпрд╛ рддрдХрдиреАрдХреА рдХрд╛рд░реНрдпреЛрдВ рдореЗрдВ рдЖрдк рдирд┐рдкреБрдг рд╣реЛрдВрдЧреЗред",
        7: "рд╡реНрдпрд╛рдкрд╛рд░, рдлрд┐рд▓реНрдо рдЬрдЧрдд рдпрд╛ рдХрд╛рдиреВрди рдХреЗ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдирд╛рдо рдХрдорд╛рдПрдВрдЧреЗред",
        8: "рдЕрдиреБрд╕рдВрдзрд╛рди, рдЬрд╛рд╕реВрд╕реА рдпрд╛ рд╕рд░реНрдЬрд░реА рдЬреИрд╕реЗ рдЧреБрдкреНрдд рдФрд░ рдЧрд╣рд░реЗ рдХрд╛рд░реНрдпреЛрдВ рдореЗрдВ рд░реБрдЪрд┐ рд░рд╣реЗрдЧреАред",
        9: "рд╢рд┐рдХреНрд╖рдг, рдзрд░реНрдо рдпрд╛ рдиреНрдпрд╛рдп рд╡реНрдпрд╡рд╕реНрдерд╛ рдореЗрдВ рдЙрдЪреНрдЪ рд╕реНрдерд╛рди рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВрдЧреЗред",
        10: "рд╕рд░рдХрд╛рд░реА рд╡рд┐рднрд╛рдЧ, рдХреГрд╖рд┐ рдпрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд╛рд░реНрдпреЛрдВ рдореЗрдВ рд╕реНрдерд┐рд░ рдкреНрд░рдЧрддрд┐ рд╣реЛрдЧреАред",
        11: "рд╡рд┐рдЬреНрдЮрд╛рди, рддрдХрдиреАрдХ рдпрд╛ рд╕рдорд╛рдЬрд╕реЗрд╡реА рд╕рдВрд╕реНрдерд╛рдУрдВ рдореЗрдВ рдЕрдЧреНрд░рдгреА рд░рд╣реЗрдВрдЧреЗред",
        12: "рдЕрдзреНрдпрд╛рддреНрдо, рд░рдЪрдирд╛рддреНрдордХ рд▓реЗрдЦрди рдпрд╛ рд╡рд┐рджреЗрд╢ рд╕реЗ рдЬреБрдбрд╝реЗ рдХрд╛рд░реНрдпреЛрдВ рдореЗрдВ рд▓рд╛рдн рд╣реЛрдЧрд╛ред"
    }
    // and so on for other houses... adding fallback logic for brevity in code but richness in categories
};

function getCategoryInterpretation(categoryKey, signId) {
    // Simplified mapping for logic
    const houseMap = {
        OVERVIEW: 1,
        CAREER: 10,
        FINANCE: 2,
        RELATIONSHIP: 7,
        FAMILY: 4,
        TRAVEL: 12,
        HEALTH: 6
    };

    const houseNum = houseMap[categoryKey];
    
    // In a full engine, we define specific interpretation for all 12x12 combinations.
    // For now, providing a robust logic base that sounds professional.
    
    if (INTERPRETATIONS[houseNum] && INTERPRETATIONS[houseNum][signId]) {
        return INTERPRETATIONS[houseNum][signId];
    }

    // Professional Fallback Logic
    const sign = SIGN_TRAITS[signId];
    switch (categoryKey) {
        case 'FINANCE': return `${sign.name} рд░рд╛рд╢рд┐ рдХреЗ рдкреНрд░рднрд╛рд╡ рд╕реЗ рдЖрдкрдХреА рдЖрд░реНрдерд┐рдХ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд╕реНрдерд┐рд░рддрд╛ рд░рд╣реЗрдЧреАред ${sign.nature === 'рд╕реНрдерд┐рд░' ? 'рдмрдЪрдд рдХрд░рдирд╛ рдЖрдкрдХреА рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реИред' : 'рдЖрдп рдХреЗ рдирдП рд╕реНрд░реЛрдд рдмрдирддреЗ рд░рд╣реЗрдВрдЧреЗред'}`;
        case 'RELATIONSHIP': return `рд╡рд┐рд╡рд╛рд╣ рдФрд░ рд╕рдВрдмрдВрдзреЛрдВ рдореЗрдВ рдЖрдк ${sign.traits} рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рдХрд░реЗрдВрдЧреЗред рдЬреАрд╡рдирд╕рд╛рдереА рдХреЗ рд╕рд╛рде рд╕рд╛рдордВрдЬрд╕реНрдп рдЕрдЪреНрдЫрд╛ рд░рд╣реЗрдЧрд╛ред`;
        case 'FAMILY': return `рдкрд╛рд░рд┐рд╡рд╛рд░рд┐рдХ рд╕реБрдЦ рдЕрдЪреНрдЫрд╛ рд░рд╣реЗрдЧрд╛ред ${sign.element === 'рдЬрд▓' ? 'рдШрд░ рдореЗрдВ рд╢рд╛рдВрддрд┐рдкреВрд░реНрдг рд╡рд╛рддрд╛рд╡рд░рдг рд░рд╣реЗрдЧрд╛ред' : 'рдкрд░рд┐рд╡рд╛рд░ рдореЗрдВ рд╕рдХреНрд░рд┐рдпрддрд╛ рдмрдиреА рд░рд╣реЗрдЧреАред'}`;
        case 'TRAVEL': return `рдЖрдкрдХреЛ ${sign.nature === 'рдЪрд░' ? 'рдЕрдХреНрд╕рд░ рдпрд╛рддреНрд░рд╛рдУрдВ рдХреЗ рдЕрд╡рд╕рд░ рдорд┐рд▓реЗрдВрдЧреЗред' : 'рд╕реНрдерд┐рд░ рдЖрд╡рд╛рд╕ рдкрд╕рдВрдж рд╣реЛрдЧрд╛, рд▓реЗрдХрд┐рди рд▓рдВрдмреА рдпрд╛рддреНрд░рд╛рдПрдВ рд╕рдВрднрд╡ рд╣реИрдВред'}`;
        case 'HEALTH': return `рд╕реНрд╡рд╛рд╕реНрдереНрдп рд╕рд╛рдорд╛рдиреНрдпрддрдГ рдЕрдЪреНрдЫрд╛ рд░рд╣реЗрдЧрд╛ред ${sign.element === 'рдЕрдЧреНрдирд┐' ? 'рдЧрд░реНрдореА рдЬрдирд┐рдд рд░реЛрдЧреЛрдВ рд╕реЗ рд╕рд╛рд╡рдзрд╛рди рд░рд╣реЗрдВред' : 'рдирд┐рдпрдорд┐рдд рдпреЛрдЧ рдФрд░ рдзреНрдпрд╛рди рдЖрдкрдХреЗ рд▓рд┐рдП рд▓рд╛рднрдХрд╛рд░реА рд╣реИред'}`;
        default: return "рдЬреНрдпреЛрддрд┐рд╖реАрдп рдЧрдгрдирд╛ рдЕрдиреБрд╕рд╛рд░ рд╕рдордп рдЕрдиреБрдХреВрд▓ рд╣реИред";
    }
}

export function getPredictions(chartData) {
    if (!chartData || !chartData.ascendant) return null;

    const lagnaSignId = chartData.ascendant.rashi.id;

    // Calculate which sign falls in which house (Anti-clockwise)
    const houseToSignMap = {};
    for (let house = 1; house <= 12; house++) {
        let signId = (lagnaSignId + house - 1) % 12;
        if (signId === 0) signId = 12;
        houseToSignMap[house] = signId;
    }

    const predictions = Object.keys(CATEGORIES).map(key => {
        const houseNum = {
            OVERVIEW: 1,
            CAREER: 10,
            FINANCE: 2,
            RELATIONSHIP: 7,
            FAMILY: 4,
            TRAVEL: 12,
            HEALTH: 6
        }[key];

        const signId = houseToSignMap[houseNum];

        return {
            category: key,
            title: CATEGORIES[key].title,
            icon: CATEGORIES[key].icon,
            content: getCategoryInterpretation(key, signId)
        };
    });

    return predictions;
}
